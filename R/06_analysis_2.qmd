---
title: "06_analysis_2"
author: "Group 29: Helena MÃ¸ller, Emma Christensen, Frederik Holmstrup, Casper Harreby & Laura Christiansen"
format: html
execute: 
  message: FALSE
  warning: FALSE
---

# Data modeling

## Loading Libraries

```{r}
#| eval: true
#| echo: true

library("tidyverse") 
library("ggplot2") 
library("dplyr") 
library("readr") 
library("here")
```

## Import the dataset

```{r}

# Load the dataset   
data <- read_tsv(here("data/03_dat_aug.tsv"))
```

## Analysis Obejctive

This analysis investigates whether`AGE` can predict the following probabilities making a simple linear model for prediction of:

-   `EXPDD` (Predicted probability of death/dependence at 6 month)

-   `EXPD6` (Predicted probability of death at 6 month)

-   `EXPD14` (Predicted probability of death at 14 days)

We will visualize the relationships between `AGE` and these outcomes using scatter plots.

### Model 1: Predicting `EXPDD` with `AGE`

```{r}

# Linear regression for EXPDD 
model_1 <- data |> 
  filter(STYPE == "LACS") |> 
  lm(data = _,
     EXPDD ~ AGE)
```

```{r}

# Display model summary 
model_1 |> 
  summary()
```

```{r}

# Plotting AGE vs log10(EXPDD)
p1 <- data |> 
        filter(STYPE == "LACS") |> 
        ggplot(aes(x = AGE, y = log10(EXPDD))) +
        geom_point(color = "PURPLE")

print(p1)
```

### Model 2: Predicting `EXPD6` with `AGE`

```{r}

# Linear regression for EXPD6
model_2 <- data |> 
  filter(STYPE == "LACS") |> 
  lm(data = _,
     log2(EXPD6) ~ AGE)
```

```{r}

# Display model summary 
model_2 |> 
  summary()
```

```{r}

# Plotting AGE vs log2(EXPD6)
p2 <- data |> 
        filter(STYPE == "LACS") |> 
        ggplot(aes(x = AGE, y = log2(EXPD6))) +
        geom_point(color = "BLUE")

print(p2)
```

### Model 3: Predicting `EXPD14` with `AGE`

```{r}

# Linear regression for EXPD14
model_3 <- data |> 
  filter(STYPE == "LACS") |> 
  lm(data = _, log2(EXPD14) ~ AGE)
```

```{r}

# Display model summary
model_3 |> 
  summary()
```

```{r}

# Plotting AGE vs. log2(EXPD14)
p3 <- data |> 
        filter(STYPE == "LACS") |> 
        ggplot(aes(x = AGE, y = log2(EXPD14))) +
        geom_point(color = "RED")

print(p3)
```

## Saving Plots

To document the results, the plots are saved in the `results` folder.

```{r}

ggsave(filename = here("results/14_keyplot_a.png"), plot = p1, width = 8, height = 4, dpi = 300, bg = "white")  
ggsave(filename = here("results/14_keyplot_b.png"), plot = p2, width = 8, height = 4, dpi = 300, bg = "white")
ggsave(filename = here("results/14_keyplot_c.png"), plot = p3, width = 8, height = 4, dpi = 300, bg = "white")
```
